{% extends 'base.html' %}

{% block title %}{{ service.name }} - Service Details{% endblock %}

{% block content %}
<div class="row">
  <div class="col-md-8">
    <div class="card mb-4">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-start mb-3">
          <div>
            <h2>{{ service.name }}</h2>
            <p class="text-muted"><strong>Type:</strong> {{ service.get_service_type_display }}</p>
          </div>
          <a href="{{ google_maps_url }}" target="_blank" class="btn btn-primary btn-sm">
            <i class="fas fa-directions"></i> Get Directions
          </a>
        </div>
        
        {% if service.description %}
          <hr>
          <h5>Description</h5>
          <p>{{ service.description }}</p>
        {% endif %}
        
        <hr>
        <h5>Location</h5>
        <ul class="list-unstyled">
          {% if service.building %}
            <li>üìç <strong>Building:</strong> <a href="{% url 'building_detail' service.building.id %}">{{ service.building.name }}</a></li>
          {% endif %}
          {% if service.room %}
            <li>üö™ <strong>Room:</strong> {{ service.room.room_number }} - {{ service.room.name }}</li>
          {% endif %}
          {% if service.floor %}
            <li>üìä <strong>Floor:</strong> {{ service.floor.floor_name }}</li>
          {% endif %}
          <li>üìê <strong>Coordinates:</strong> {{ service.latitude }}, {{ service.longitude }}</li>
        </ul>
        
        {% if service.contact_phone or service.office_hours %}
          <hr>
          <h5>Contact & Hours</h5>
          <ul class="list-unstyled">
            {% if service.contact_phone %}
              <li>üìû <strong>Phone:</strong> {{ service.contact_phone }}</li>
            {% endif %}
            {% if service.office_hours %}
              <li>‚è∞ <strong>Hours:</strong> {{ service.office_hours }}</li>
            {% endif %}
          </ul>
        {% endif %}
        
        {% if service.accessibility_features %}
          <hr>
          <h5>‚ôø Accessibility</h5>
          <div class="alert alert-success">{{ service.accessibility_features }}</div>
        {% endif %}
      </div>
    </div>
  </div>
  
  <div class="col-md-4">
    <!-- Service Map -->
    <div class="card mb-4">
      <div class="card-body p-0">
        <div id="service-map" style="height: 300px;"></div>
      </div>
    </div>
    
    <!-- Nearby Services -->
    {% if nearby_services %}
      <div class="card">
        <div class="card-header bg-primary text-white">
          <h6 class="mb-0">Nearby Services</h6>
        </div>
        <div class="card-body">
          <ul class="list-group list-group-flush">
            {% for nearby, distance in nearby_services %}
              <li class="list-group-item">
                <div class="d-flex justify-content-between align-items-start mb-2">
                  <div>
                    <a href="{% url 'service_detail' nearby.id %}">{{ nearby.name }}</a>
                    <br><small class="text-muted">{{ nearby.get_service_type_display }}</small>
                  </div>
                  <span class="badge bg-info">{{ distance }} km</span>
                </div>
                <small>
                  <a href="https://www.google.com/maps/dir/?api=1&origin={{ service.latitude }},{{ service.longitude }}&destination={{ nearby.latitude }},{{ nearby.longitude }}&travelmode=walking" 
                     target="_blank" class="btn btn-sm btn-outline-primary">
                    <i class="fas fa-directions"></i> Route
                  </a>
                </small>
              </li>
            {% endfor %}
          </ul>
        </div>
      </div>
    {% endif %}
  </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const map = initMap('service-map', [{{ service.latitude }}, {{ service.longitude }}], 17);
    addMarker(map, {{ service.latitude }}, {{ service.longitude }}, "{{ service.name }}", "<strong>{{ service.name }}</strong><br>{{ service.get_service_type_display }}");
  });
</script>
{% endblock %}
